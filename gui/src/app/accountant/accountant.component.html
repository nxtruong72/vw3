<!-- <h1 style="margin: auto;align-content: center">Report</h1> -->
<mat-tab-group>
  <mat-tab label="Accountant">
    <div class="container-fluid">
      <div class="row" style="margin-top: 2rem">
        <div class="col-md-4"></div>
        <div class="col-md-8">
          <mat-radio-group [(ngModel)]="chosenItem" (change)="onRadioButtonChange()">
            <mat-radio-button style="margin-right: 20px;" value='today'>Today</mat-radio-button>
            <mat-radio-button style="margin-right: 20px;" value='yesterday'>Yesterday</mat-radio-button>
            <mat-radio-button style="margin-right: 20px;" value='this_week'>This week</mat-radio-button>
            <mat-radio-button style="margin-right: 20px;" value='last_week'>Last week</mat-radio-button>
          </mat-radio-group>
        </div>
    
    
        <div class="col-md-4"></div>
        <div class="col-md-8">
          <mat-form-field style="margin-right: 20px;">
            <input matInput [matDatepicker]="from" placeholder="From date" [formControl]="fromDate">
            <mat-datepicker-toggle matSuffix [for]="from"></mat-datepicker-toggle>
            <mat-datepicker #from></mat-datepicker>
          </mat-form-field>
          <mat-form-field style="margin-right: 20px;">
            <input matInput [matDatepicker]="to" placeholder="To date" [formControl]="toDate">
            <mat-datepicker-toggle matSuffix [for]="to"></mat-datepicker-toggle>
            <mat-datepicker #to></mat-datepicker>
          </mat-form-field>
          <button mat-raised-button color="primary" style="margin-right: 20px;" (click)="onClickScan()">Scan</button>
          <!-- <button mat-raised-button color="primary" (click)="onClickReport()">Report</button> -->
        </div>
      </div>
    </div>

    <div class="container content">
      <!-- Status for scanning -->
      <div class="data-div" *ngIf="statusList.size > 0">
        <mat-card style="background-color: aquamarine">
          <mat-card-header>
            <mat-card-title [style.background-color]="red">Status</mat-card-title>
          </mat-card-header>
          <mat-card-content [style.background-color]="red">
            <mat-chip-list>
              <div class="col-md-3" *ngFor="let item of statusList | keyvalue">
                <mat-chip>
                  {{item.key | uppercase}}:&nbsp;{{item.value}}
                </mat-chip>
              </div>
            </mat-chip-list>
          </mat-card-content>
        </mat-card>
      </div>

      <!-- Check all -->
      <div *ngIf="bankerMap.size > 0">
        <mat-checkbox class="tp-margin" [(ngModel)]="isCheckAll" (change)="onCheckAll()">Check all</mat-checkbox>
      </div>

      <mat-accordion>
        <div class="data-div" *ngFor="let entry of bankerMap | keyvalue">
          <mat-expansion-panel>
            <mat-expansion-panel-header style="background-color: lightgray">
              <mat-panel-title>
                <section class="tp-section">
                  <mat-checkbox class="tp-margin" [(ngModel)]="entry.value.isChecked"
                    (change)="onCheckBoxChange(entry.value)">{{entry.value.name | uppercase}}
                  </mat-checkbox>
                </section>
              </mat-panel-title>
            </mat-expansion-panel-header>

            <div class="data-children" *ngFor="let accountant of entry.value.children | keyvalue">
              <mat-expansion-panel>
                <mat-expansion-panel-header style="background-color: lightblue">
                  <mat-panel-title>
                    <section class="tp-section">
                      <mat-checkbox class="tp-margin" [(ngModel)]="accountant.value.isChecked"
                        (change)="onCheckBoxChange(accountant.value)">
                        {{accountant.value.name | uppercase}}
                      </mat-checkbox>
                    </section>
                  </mat-panel-title>
                  <mat-panel-description>
                    {{accountant.value.note | uppercase}}
                  </mat-panel-description>
                </mat-expansion-panel-header>

                <div style="background-color:rgb(202, 223, 230)" *ngIf="accountant.value.children.size > 0">
                  <table class="table table-hover">
                    <thead class="table-primary">
                      <th style="vertical-align : middle;text-align:center;">Account</th>
                      <th>Type</th>
                      <th>Turn over</th>
                      <th *ngIf="entry.value.book_name != 'loto'">Gross comm</th>
                      <th *ngIf="entry.value.book_name == 'loto'">Payout</th>
                    </thead>
                    <tbody>
                      <!-- sport book -->
                      <ng-container *ngFor="let account of accountant.value.children | keyvalue">
                        <tr *ngFor="let element of account.value.data | keyvalue; let i = index">
                          <td *ngIf="i == 0" [attr.rowspan]="getObjectLength(account.value.data)" style="vertical-align : middle;text-align:center;">
                            {{account.value.name}}
                          </td>
                          <td>{{element.key | uppercase}}</td>
                          <td>{{element.value.turnover | number:0}}</td>
                          <td *ngIf="element.value.gross_comm != undefined">{{element.value.gross_comm | number:0}}</td>
                          <td *ngIf="element.value.payout != undefined">{{element.value.payout | number:0}}</td>
                        </tr>
                      </ng-container>
                    </tbody>
                  </table>
                </div>
              </mat-expansion-panel>
            </div>
          </mat-expansion-panel>
        </div>
      </mat-accordion>
    </div>
  </mat-tab>

  <!-- Report tab -->
  <mat-tab label="Report">
    <div class="container content" style="margin-top: 2rem">
      <!-- <div style="text-align: center; border: 1px solid black;">
        Icon goes here {{bankerMap}}
      </div> -->

      <table class="table table-bordered" style="vertical-align : middle;text-align:center;">
        <thead class="thead-dark">
          <tr>
            <th scope="col" colspan="3">BẢNG THỐNG KÊ ĐẠI LÝ</th>
            <th scope="col">TỶ GIÁ $ 23200</th>
          </tr>
          <tr>
            <th scope="col">LOẠI</th>
            <th scope="col">CÔNG TY</th>
            <th scope="col">TURNOVER</th>
            <th scope="col">TÀI KHOẢN HOẠT ĐỘNG</th>
          </tr>
        </thead>

        <tbody>
          <!-- Sport book -->
          <ng-container *ngIf="sbCounter.length > 0">
            <tr *ngFor="let banker of sbCounter; let i = index">
              <td *ngIf="i == 0" [attr.rowspan]="sbCounter.length" style="vertical-align : middle;text-align:center;">
                SPORTBOOK</td>
              <td>{{banker.name | uppercase}}</td>
              <td>{{banker.data.sb.turnover | number}}</td>
              <td>{{banker.total_account | number}}</td>
            </tr>
          </ng-container>

          <!-- Ga -->
          <ng-container *ngIf="cfCounter.length > 0">
            <tr *ngFor="let banker of cfCounter; let i = index">
              <td *ngIf="i == 0" [attr.rowspan]="cfCounter.length" style="vertical-align : middle;text-align:center;">GÀ
              </td>
              <td>{{banker.name | uppercase}}</td>
              <td>{{banker.data.cf.turnover | number}}</td>
              <td>{{banker.total_account | number}}</td>
            </tr>
          </ng-container>

          <!-- Casino -->
          <ng-container *ngIf="csnCounter.length > 0">
            <tr *ngFor="let banker of csnCounter; let i = index">
              <td *ngIf="i == 0" [attr.rowspan]="csnCounter.length" style="vertical-align : middle;text-align:center;">
                CASINO</td>
              <td>{{banker.name | uppercase}}</td>
              <td>{{banker.data.csn.turnover | number}}</td>
              <td>{{banker.total_account | number}}</td>
            </tr>
          </ng-container>

          <!-- Loto -->
          <ng-container *ngIf="lotoCounter.length > 0">
            <tr *ngFor="let banker of lotoCounter; let i = index">
              <td *ngIf="i == 0" [attr.rowspan]="lotoCounter.length" style="vertical-align : middle;text-align:center;">
                LOTO</td>
              <td>{{banker.name | uppercase}}</td>
              <td>{{banker.data.loto.turnover | number}}</td>
              <td>{{banker.total_account | number}}</td>
            </tr>
          </ng-container>
        </tbody>
      </table>
    </div>
  </mat-tab>

  <!-- Member tab -->
  <mat-tab label="Member">
    <app-member [bankerMap]="bankerMap"></app-member>
  </mat-tab>
</mat-tab-group>